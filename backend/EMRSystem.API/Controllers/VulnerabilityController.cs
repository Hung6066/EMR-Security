[Authorize(Roles="Admin,Security")] [Route("api/security/vulnerabilities")]
public class VulnerabilityController : ControllerBase {
    private readonly IVulnerabilityService _svc;
    public VulnerabilityController(IVulnerabilityService svc) { _svc = svc; }
    [HttpGet] public Task<List<Vulnerability>> Get() => _svc.GetVulnerabilitiesAsync();
    [HttpPost("import")] public async Task<IActionResult> Import(string scanner, IFormFile file) {
        using var reader = new StreamReader(file.OpenReadStream());
        var content = await reader.ReadToEndAsync();
        await _svc.ImportScanResultsAsync(scanner, content);
        return Ok();
    }
    [HttpPut("{id}/status")] public async Task<IActionResult> Update(int id, [FromBody] string status) { await _svc.UpdateStatusAsync(id, status); return Ok(); }
}