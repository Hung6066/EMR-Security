<!-- src/app/components/security/password-policy/password-policy.component.html -->
<div class="policy-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>policy</mat-icon>
        Password Policy Management
      </mat-card-title>
      <mat-card-subtitle>Cấu hình yêu cầu và vòng đời của mật khẩu</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content *ngIf="!loading">
      <form [formGroup]="policyForm" (ngSubmit)="savePolicy()">
        <div class="section">
          <h3>Độ phức tạp</h3>
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Độ dài tối thiểu</mat-label>
              <input matInput type="number" formControlName="minLength">
            </mat-form-field>

            <mat-slide-toggle formControlName="requireLowercase">Yêu cầu chữ thường</mat-slide-toggle>
            <mat-slide-toggle formControlName="requireUppercase">Yêu cầu chữ hoa</mat-slide-toggle>
            <mat-slide-toggle formControlName="requireDigit">Yêu cầu chữ số</mat-slide-toggle>
            <mat-slide-toggle formControlName="requireNonAlphanumeric">Yêu cầu ký tự đặc biệt</mat-slide-toggle>
          </div>
        </div>
        
        <mat-divider></mat-divider>
        
        <div class="section">
          <h3>Vòng đời và Lịch sử</h3>
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Hết hạn sau (ngày)</mat-label>
              <input matInput type="number" formControlName="expireDays">
            </mat-form-field>
            
            <mat-form-field appearance="outline">
              <mat-label>Lưu lịch sử (mật khẩu)</mat-label>
              <input matInput type="number" formControlName="passwordHistory">
              <mat-hint>Không cho dùng lại N mật khẩu gần nhất</mat-hint>
            </mat-form-field>
          </div>
        </div>

        <mat-divider></mat-divider>

        <div class="section">
          <h3>Bảo mật bổ sung</h3>
          <div class="form-grid">
            <mat-slide-toggle formControlName="checkPwnedPasswords">
              Kiểm tra mật khẩu đã bị lộ (HIBP)
            </mat-slide-toggle>
          </div>
        </div>

        <mat-divider></mat-divider>
        
        <div class="section">
          <h3>Khóa tài khoản</h3>
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Số lần đăng nhập sai tối đa</mat-label>
              <input matInput type="number" formControlName="maxFailedAccessAttempts">
            </mat-form-field>
            
            <mat-form-field appearance="outline">
              <mat-label>Thời gian khóa (phút)</mat-label>
              <input matInput type="number" formControlName="lockoutMinutes">
            </mat-form-field>
          </div>
        </div>

        <mat-card-actions align="end">
          <button mat-raised-button color="primary" type="submit" [disabled]="!policyForm.valid || loading">
            <mat-icon>save</mat-icon>
            Lưu thay đổi
          </button>
        </mat-card-actions>
      </form>
    </mat-card-content>
    <div *ngIf="loading" class="loading-spinner">
      <mat-spinner></mat-spinner>
    </div>
  </mat-card>
</div>